# stellar-parameters-NN

Development in astronomical observation technology and the emergence of large-sky surveys (GAIA- RVS, LSST, APOGEE) in the last decade will result in the reveal of huge stellar spectral data. Therefore, automated processing techniques are needed for stellar parametrization and statistical exploration of spectrum-parameter dependencies. We devise a deep neural network with the capability of inverting four stellar parameters (Teff,log(g),[Fe/H],vsin(i)) for A and FGK stars when trained on synthetic spectra. The synthetic spectra were based on models generated by ATLAS9 and by the spectrum synthesis code SYNSPEC48.

* 0.join.py : joins the different databases and stack them in one indexed database
* 1.label_study.py : explores the created datasets just to investigate the distribution of each label.
* 2.pre_processing.py : This standarizes the label datasets using the individual means and standard
deviations corresponding to each label. Shuffles the entire datasets, stores them in a new h5py database file containing the shuffled spectra and standarized labels together with the individual mean and standard deviations. The mean and standard deviations are stored so that re-standarization can be performed in the testing phase (file 4.test.py)
* 3.train.py : creates a network composed of two 1-dimensional convolutional layers, 1-dimensional maxpooling layers, and two dense layers linearily stacked in Sequential mode. The model is optimized by the first-order adaptive gradient-based optimization scheme ADAM equipped with EarlyStopping and ReduceLRonPlateau callbacks.
* 4.test.py : After training is done and the model's wieghts are saved, the network can be thus used to predict on new datasets. This code applies the converged model to new data. The testing dataset is noised using gaussian noise prior to test.
* jacobian.py : explores the input-output layers dependencies by calculating the jacobian of the network

It is possible to determine the features which the neural network is identifying in a given spectra when predicting each stellar parameter. This can be done by calculating the partial derivatives of each of the ouputs (Teff, logg, [Fe/H], vsin(i)) with respect to every input flux value of the spectrum and built the networkâ€™s Jacobian. For this test, 300 Jacobians were calculated and averaged for 300 randomly choosen spectra. This is the greatest indicative of the success of this technique as it reflects physical dependencies inferred from the data. For exmaple, the vsini_jac.png file show the Jacobian of the model where the derivatives of the vsini output neuron with respect to the input neurons is visualized and clearly shows the strong dependency of vsini to the Hydrogen Balmer line at 4860A, the FeII line from 4500A to 4530A, the magnesium triplet at 4480A, and different weak metallic lines. 
