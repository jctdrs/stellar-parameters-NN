# stellar-parameters-NN

Development in astronomical observation technology and the emergence of large-sky surveys (GAIA- RVS, LSST, APOGEE) in the last decade will result in the reveal of huge stellar spectral data. Therefore, automated processing techniques are needed for stellar parametrization and statistical exploration of spectrum-parameter dependencies. We devise a deep neural network with the capability of inverting four stellar parameters (Teff,log(g),[Fe/H],vsin(i)) for A and FGK stars when trained on synthetic spectra. The synthetic spectra were based on models generated by ATLAS9 and by the spectrum synthesis code SYNSPEC48.

1. `join.py` joins the different databases and stack them in one indexed database
2. `label_study.py` explores the created datasets to investigate the distribution of each label.
[label](images/label_grid.png)
3. `pre_processing.py` standarizes the label datasets using the individual means and standard deviations corresponding to each label. Shuffles the entire datasets, stores them in a new h5py database file containing the shuffled spectra and standarized labels together with the individual mean and standard deviations. The mean and standard deviations are stored so that re-standarization can be performed in the testing phase
4. `train.py` creates a network composed of two 1-dimensional convolutional layers, 1-dimensional maxpooling layers, and two dense layers linearily stacked in Sequential mode. The model is optimized by the first-order adaptive gradient-based optimization scheme ADAM equipped with EarlyStopping and ReduceLRonPlateau callbacks
5. `test.py` After training is done and the model's wieghts are saved, the network can be thus used to predict on new datasets. This code uses the converged model to predict the parameters of new spectra. The testing dataset is noised using gaussian noise prior to test.
[prediction!](images/pred.png)
6. `jacobian.py` explores the input-output layers dependencies by calculating the jacobian of the network

It is possible to determine the wavelengths which the neural network has found to be the most indicative to each stellar parameter. This can be done by calculating the partial derivatives of each of the ouputs (Teff, logg, [Fe/H], vsin(i)) with respect to every input wavelength of the spectrum. This is the greatest indicative of the success of this technique as it reflects physical dependencies inferred from the data. For exmaple, the for the vsini theJacobian of the model is visualized and clearly shows the strong dependency of vsini to the Hydrogen Balmer line at 4860A, the FeII line from 4500A to 4530A, the magnesium triplet at 4480A, and different weak metallic lines as seen in the image below. 
[vsini!](images/vsini_jac.png)
